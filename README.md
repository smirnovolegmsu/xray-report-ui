# Xray Report UI

–í–µ–±-–ø–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –¥–ª—è Xray VPN —Å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–æ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏.

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### –£—Å—Ç–∞–Ω–æ–≤–∫–∞

```bash
cd /opt/xray-report-ui
python3 -m venv venv
source venv/bin/activate
pip install flask
```

### –ó–∞–ø—É—Å–∫

```bash
# –ß–µ—Ä–µ–∑ systemd (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
systemctl start xray-report-ui
systemctl enable xray-report-ui

# –ò–ª–∏ –≤—Ä—É—á–Ω—É—é
python3 app.py
```

–ó–∞—Ç–µ–º –æ—Ç–∫—Ä–æ–π—Ç–µ –≤ –±—Ä–∞—É–∑–µ—Ä–µ: `http://YOUR_IP:8787`

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
xray-report-ui/
‚îú‚îÄ‚îÄ üåê FRONTEND (—á—Ç–æ –≤–∏–¥–∏—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å)
‚îÇ   ‚îú‚îÄ‚îÄ templates/index.html    - HTML —Å—Ç—Ä–∞–Ω–∏—Ü–∞
‚îÇ   ‚îî‚îÄ‚îÄ static/
‚îÇ       ‚îú‚îÄ‚îÄ css/styles.css      - –°—Ç–∏–ª–∏
‚îÇ       ‚îî‚îÄ‚îÄ js/*.js             - –ú–æ–¥—É–ª–∏ JavaScript
‚îÇ
‚îú‚îÄ‚îÄ üêç BACKEND (–ª–æ–≥–∏–∫–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ)
‚îÇ   ‚îî‚îÄ‚îÄ app.py                  - Flask —Å–µ—Ä–≤–µ—Ä (–≤—Å—è –ª–æ–≥–∏–∫–∞ –≤ –æ–¥–Ω–æ–º —Ñ–∞–π–ª–µ)
‚îÇ
‚îú‚îÄ‚îÄ üóÑÔ∏è –ê–†–•–ò–í (–Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è)
‚îÇ   ‚îî‚îÄ‚îÄ _archive_legacy/        - –°—Ç–∞—Ä—ã–µ –ø—Ä–æ—Ç–æ—Ç–∏–ø—ã –∏ –Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–π –∫–æ–¥
‚îÇ
‚îî‚îÄ‚îÄ üíæ –î–ê–ù–ù–´–ï (–Ω–µ –≤ Git)
    ‚îú‚îÄ‚îÄ data/                   - –†–∞–±–æ—á–∏–µ –¥–∞–Ω–Ω—ã–µ
    ‚îî‚îÄ‚îÄ venv/                   - Python –æ–∫—Ä—É–∂–µ–Ω–∏–µ
```

## üìö –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

**–ù–∞—á–Ω–∏—Ç–µ —Å —ç—Ç–∏—Ö —Ñ–∞–π–ª–æ–≤:**

1. **[PROJECT_STRUCTURE.md](PROJECT_STRUCTURE.md)** üî• - –ü–æ–¥—Ä–æ–±–Ω–æ–µ –æ–±—ä—è—Å–Ω–µ–Ω–∏–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã
2. **[README_REFACTORING.md](README_REFACTORING.md)** - –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ—Å–ª–µ —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞
3. **[REFACTORING_REPORT.md](REFACTORING_REPORT.md)** - –û—Ç—á–µ—Ç –æ –ø—Ä–æ–¥–µ–ª–∞–Ω–Ω–æ–π —Ä–∞–±–æ—Ç–µ

## ‚ú® –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- ‚úÖ **–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏** - –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ, —É–¥–∞–ª–µ–Ω–∏–µ, kick
- ‚úÖ **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Ç—Ä–∞—Ñ–∏–∫–∞** - daily/cumulative –≥—Ä–∞—Ñ–∏–∫–∏
- ‚úÖ **Live —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞** - real-time –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
- ‚úÖ **–ò—Å—Ç–æ—Ä–∏—è** - –¥–µ—Ç–∞–ª—å–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∑–∞ 7 –¥–Ω–µ–π
- ‚úÖ **–¢–æ–ø –¥–æ–º–µ–Ω—ã** - –∞–Ω–∞–ª–∏–∑ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
- ‚úÖ **–°–æ–±—ã—Ç–∏—è** - –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –¥–µ–π—Å—Ç–≤–∏–π
- ‚úÖ **–õ–æ–∫–∞–ª–∏–∑–∞—Ü–∏—è** - RU/EN
- ‚úÖ **–¢–µ–º–Ω–∞—è/—Å–≤–µ—Ç–ª–∞—è —Ç–µ–º–∞**

## üéØ –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç

### –ü—Ä–æ—Å—Ç–æ–π –ø–æ—Ç–æ–∫:

```
–ë—Ä–∞—É–∑–µ—Ä ‚Üí index.html ‚Üí –∑–∞–≥—Ä—É–∂–∞–µ—Ç JS ‚Üí –¥–µ–ª–∞–µ—Ç API –∑–∞–ø—Ä–æ—Å
                                              ‚Üì
                                         app.py
                                              ‚Üì
                                    –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ
                                              ‚Üì
                                    –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç JSON
                                              ‚Üì
                                    –ë—Ä–∞—É–∑–µ—Ä —Ä–∏—Å—É–µ—Ç UI
```

### –ü—Ä–∏–º–µ—Ä: –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

1. –ë—Ä–∞—É–∑–µ—Ä (`users.js`) ‚Üí `POST /api/users/add {email: "user1"}`
2. `app.py` ‚Üí —á–∏—Ç–∞–µ—Ç config, –¥–æ–±–∞–≤–ª—è–µ—Ç —é–∑–µ—Ä–∞, –¥–µ–ª–∞–µ—Ç –±—ç–∫–∞–ø
3. –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç `{ok: true}`
4. –ë—Ä–∞—É–∑–µ—Ä –æ–±–Ω–æ–≤–ª—è–µ—Ç —Ç–∞–±–ª–∏—Ü—É

## üõ†Ô∏è –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –∫–æ–¥–∞:

- **Frontend** (`static/`, `templates/`) - HTML/CSS/JS
- **Backend** (`app.py`) - –í—Å—è Python –ª–æ–≥–∏–∫–∞ –≤ –æ–¥–Ω–æ–º —Ñ–∞–π–ª–µ
- **–î–∞–Ω–Ω—ã–µ** (`data/`) - –Ω–µ –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è –≤ Git
- **–ê—Ä—Ö–∏–≤** (`_archive_legacy/`) - —É—Å—Ç–∞—Ä–µ–≤—à–∏–π –∫–æ–¥, –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π:

```bash
./test_refactoring.sh
```

## üìä –ú–µ—Ç—Ä–∏–∫–∏ —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞

| –ú–µ—Ç—Ä–∏–∫–∞ | –î–æ | –ü–æ—Å–ª–µ | –ò–∑–º–µ–Ω–µ–Ω–∏–µ |
|---------|-----|-------|-----------|
| HTML —Ä–∞–∑–º–µ—Ä | 324 KB | 32 KB | **-90%** |
| HTML —Å—Ç—Ä–æ–∫ | 9514 | ~600 | **-94%** |
| –ú–æ–¥—É–ª–µ–π | 2 | 26 | **+1200%** |
| Legacy –∫–æ–¥ | 135 —Å—Ç—Ä–æ–∫ | 0 | **-100%** |
| –ú—É—Å–æ—Ä–∞ | 1.2 MB | 0 | **-100%** |

## üîß –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### –û—Å–Ω–æ–≤–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏:

- **–ü–æ—Ä—Ç:** 8787 (–º–æ–∂–Ω–æ –∏–∑–º–µ–Ω–∏—Ç—å —á–µ—Ä–µ–∑ `XRAY_REPORT_UI_PORT`)
- **Xray config:** `/usr/local/etc/xray/config.json`
- **Usage CSV:** `/var/log/xray/usage/`
- **Data dir:** `/opt/xray-report-ui/data/`

### –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —á–µ—Ä–µ–∑ UI:

1. –û—Ç–∫—Ä—ã—Ç—å –ø–∞–Ω–µ–ª—å ‚Üí –°–∏—Å—Ç–µ–º–∞ ‚Üí –ù–∞—Å—Ç—Ä–æ–π–∫–∏
2. –£–∫–∞–∑–∞—Ç—å `server_host` (IP –∏–ª–∏ –¥–æ–º–µ–Ω –≤–∞—à–µ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞)
3. (–û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) `reality_pbk` –¥–ª—è —Ä—É—á–Ω–æ–≥–æ —É–∫–∞–∑–∞–Ω–∏—è –ø—É–±–ª–∏—á–Ω–æ–≥–æ –∫–ª—é—á–∞

## üêõ Troubleshooting

### –ü—Ä–æ–±–ª–µ–º–∞: –ù–µ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è UI

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å
systemctl status xray-report-ui

# –õ–æ–≥–∏
journalctl -u xray-report-ui -f

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ñ–∞–π–ª—ã
./test_refactoring.sh
```

### –ü—Ä–æ–±–ª–µ–º–∞: –ù–µ —Ä–∞–±–æ—Ç–∞—é—Ç –≥—Ä–∞—Ñ–∏–∫–∏

1. –û—Ç–∫—Ä—ã—Ç—å DevTools (F12) ‚Üí Console
2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –æ—à–∏–±–∫–∏ JavaScript
3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ —Ñ–∞–π–ª—ã –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è (Network tab)

### –ü—Ä–æ–±–ª–µ–º–∞: –ù–µ –≤–∏–¥–Ω–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å `/usr/local/etc/xray/config.json` —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞ –∫ config.json
3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏: `journalctl -u xray-report-ui`

## üéâ –ò—Ç–æ–≥–∏

**Frontend:** ‚úÖ –ó–∞–≤–µ—Ä—à–µ–Ω (–º–æ–¥—É–ª—å–Ω—ã–π, –±—ã—Å—Ç—Ä—ã–π)  
**Backend:** ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç (–º–æ–Ω–æ–ª–∏—Ç–Ω—ã–π app.py)  
**–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ:** ‚úÖ Production Ready
**–ê—Ä—Ö–∏–≤:** ‚úÖ Legacy –∫–æ–¥ –ø–µ—Ä–µ–Ω–µ—Å–µ–Ω –≤ `_archive_legacy/`

---

**–í–µ—Ä—Å–∏—è:** 2.0  
**–î–∞—Ç–∞:** 2026-01-18  
**–°—Ç–∞—Ç—É—Å:** Production Ready ‚úÖ
