# üîç –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å —Å–µ—Ä–≤–µ—Ä–æ–≤

## ‚úÖ –ß—Ç–æ –±—ã–ª–æ —Å–¥–µ–ª–∞–Ω–æ –¥–ª—è –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è –æ—Ç–∫–ª—é—á–µ–Ω–∏—è —Å–µ—Ä–≤–µ—Ä–æ–≤

### 1. –û—á–∏—Å—Ç–∫–∞ –¥–∏—Å–∫–æ–≤–æ–≥–æ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞
- **–û—Å–≤–æ–±–æ–∂–¥–µ–Ω–æ ~2GB** –º–µ—Å—Ç–∞ –Ω–∞ –¥–∏—Å–∫–µ
- –ù–∞—Å—Ç—Ä–æ–µ–Ω–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Ä–æ—Ç–∞—Ü–∏—è –ª–æ–≥–æ–≤ journalctl (–º–∞–∫—Å–∏–º—É–º 500MB)
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—á–∏—Å—Ç–∫–∞ —Å—Ç–∞—Ä—ã—Ö –±—ç–∫–∞–ø–æ–≤ (–æ—Å—Ç–∞–≤–ª—è–µ—Ç—Å—è 50 –ø–æ—Å–ª–µ–¥–Ω–∏—Ö)

### 2. –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è —Ä–µ—Å—É—Ä—Å–æ–≤ –≤ systemd

#### Frontend (xray-nextjs-ui):
- **MemoryMax**: 512MB (–∂–µ—Å—Ç–∫–∏–π –ª–∏–º–∏—Ç)
- **MemoryHigh**: 400MB (–º—è–≥–∫–∏–π –ª–∏–º–∏—Ç)
- **CPUQuota**: 150%
- **TasksMax**: 50 –ø—Ä–æ—Ü–µ—Å—Å–æ–≤

#### Backend (xray-report-ui):
- **MemoryMax**: 256MB (–∂–µ—Å—Ç–∫–∏–π –ª–∏–º–∏—Ç)
- **MemoryHigh**: 200MB (–º—è–≥–∫–∏–π –ª–∏–º–∏—Ç)
- **CPUQuota**: 100%
- **TasksMax**: 20 –ø—Ä–æ—Ü–µ—Å—Å–æ–≤

### 3. –£–ª—É—á—à–µ–Ω–Ω—ã–π –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

–°–∫—Ä–∏–ø—Ç `/opt/xray-report-ui/scripts/services/check.sh` —Ç–µ–ø–µ—Ä—å –ø—Ä–æ–≤–µ—Ä—è–µ—Ç:
- ‚úÖ –°—Ç–∞—Ç—É—Å —Å–µ—Ä–≤–∏—Å–æ–≤
- ‚úÖ –î–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å –ø–æ—Ä—Ç–æ–≤
- ‚úÖ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –¥–∏—Å–∫–∞ (–∞–≤—Ç–æ–æ—á–∏—Å—Ç–∫–∞ –ø—Ä–∏ >85%)
- ‚úÖ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø–∞–º—è—Ç–∏ (–∞–ª–µ—Ä—Ç –ø—Ä–∏ >90%)
- ‚úÖ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø–∞–º—è—Ç–∏ –∫–∞–∂–¥—ã–º —Å–µ—Ä–≤–∏—Å–æ–º
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—á–∏—Å—Ç–∫–∞ —Å—Ç–∞—Ä—ã—Ö –±—ç–∫–∞–ø–æ–≤
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—á–∏—Å—Ç–∫–∞ –ª–æ–≥–æ–≤

### 4. Health Checks

–°–∫—Ä–∏–ø—Ç `/opt/xray-report-ui/scripts/services/health-check.sh`:
- –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å API endpoints
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç —Ç–∞–π–º–∞—É—Ç—ã (5 —Å–µ–∫—É–Ω–¥)
- –ü–æ–≤—Ç–æ—Ä—è–µ—Ç –ø–æ–ø—ã—Ç–∫–∏ (3 —Ä–∞–∑–∞)

## üìä –¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ

### –î–∏—Å–∫:
- **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ**: ~71% (–±—ã–ª–æ 79%)
- **–°–≤–æ–±–æ–¥–Ω–æ**: ~5.3GB
- **–õ–∏–º–∏—Ç –∞–ª–µ—Ä—Ç–∞**: 85%

### –ü–∞–º—è—Ç—å:
- **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ**: ~65%
- **–õ–∏–º–∏—Ç –∞–ª–µ—Ä—Ç–∞**: 90%

### –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –¥–µ–π—Å—Ç–≤–∏—è:
- –û—á–∏—Å—Ç–∫–∞ –ª–æ–≥–æ–≤: –ø—Ä–∏ –ø—Ä–µ–≤—ã—à–µ–Ω–∏–∏ 500MB
- –û—á–∏—Å—Ç–∫–∞ –±—ç–∫–∞–ø–æ–≤: –ø—Ä–∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ >50
- –û—á–∏—Å—Ç–∫–∞ –¥–∏—Å–∫–∞: –ø—Ä–∏ –∑–∞–ø–æ–ª–Ω–µ–Ω–∏–∏ >85%

## üîß –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞:
```bash
systemctl status xray-nextjs-ui xray-report-ui
```

### –†—É—á–Ω–æ–π –∑–∞–ø—É—Å–∫ –ø—Ä–æ–≤–µ—Ä–∫–∏:
```bash
/opt/xray-report-ui/scripts/services/check.sh
```

### –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞:
```bash
tail -f /var/log/xray-services-check.log
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —Ä–µ—Å—É—Ä—Å–æ–≤:
```bash
systemctl status xray-nextjs-ui | grep Memory
systemctl status xray-report-ui | grep Memory
```

## ‚ö†Ô∏è –ê–ª–µ—Ä—Ç—ã

–°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ª–æ–≥–∏—Ä—É–µ—Ç –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è –ø—Ä–∏:
- –ó–∞–ø–æ–ª–Ω–µ–Ω–∏–∏ –¥–∏—Å–∫–∞ >85%
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ –ø–∞–º—è—Ç–∏ >90%
- –ù–µ–¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ –ø–æ—Ä—Ç–æ–≤
- –ü–∞–¥–µ–Ω–∏–∏ —Å–µ—Ä–≤–∏—Å–æ–≤

–í—Å–µ —Å–æ–±—ã—Ç–∏—è –∑–∞–ø–∏—Å—ã–≤–∞—é—Ç—Å—è –≤ `/var/log/xray-services-check.log`

## üîÑ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—á–∏—Å—Ç–∫–∞

### –õ–æ–≥–∏ journalctl:
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞—é—Ç—Å—è –¥–æ 500MB
- –°—Ç–∞—Ä—ã–µ –ª–æ–≥–∏ (>7 –¥–Ω–µ–π) —É–¥–∞–ª—è—é—Ç—Å—è

### –ë—ç–∫–∞–ø—ã:
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —É–¥–∞–ª—è—é—Ç—Å—è —Å—Ç–∞—Ä—ã–µ (–æ—Å—Ç–∞–≤–ª—è–µ—Ç—Å—è 50 –ø–æ—Å–ª–µ–¥–Ω–∏—Ö)
- –ó–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –ø—Ä–∏ –ø—Ä–æ–≤–µ—Ä–∫–µ –¥–∏—Å–∫–∞

### Cron –∑–∞–¥–∞—á–∞:
```bash
*/5 * * * * /opt/xray-report-ui/scripts/services/check.sh >/dev/null 2>&1
```

–ü—Ä–æ–≤–µ—Ä–∫–∞ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –∫–∞–∂–¥—ã–µ 5 –º–∏–Ω—É—Ç.

## üìà –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

1. **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥**: –†–µ–≥—É–ª—è—Ä–Ω–æ –ø—Ä–æ–≤–µ—Ä—è–π—Ç–µ `/var/log/xray-services-check.log`
2. **–î–∏—Å–∫**: –ü—Ä–∏ –∑–∞–ø–æ–ª–Ω–µ–Ω–∏–∏ >90% –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –∏ –±—ç–∫–∞–ø—ã –≤—Ä—É—á–Ω—É—é
3. **–ü–∞–º—è—Ç—å**: –ü—Ä–∏ –ø–æ—Å—Ç–æ—è–Ω–Ω–æ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ >85% —Ä–∞—Å—Å–º–æ—Ç—Ä–∏—Ç–µ —É–≤–µ–ª–∏—á–µ–Ω–∏–µ –ª–∏–º–∏—Ç–æ–≤
4. **–†–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ**: –†–µ–≥—É–ª—è—Ä–Ω–æ –¥–µ–ª–∞–π—Ç–µ –±—ç–∫–∞–ø—ã –≤–∞–∂–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö

## üö® –ß—Ç–æ –¥–µ–ª–∞—Ç—å –ø—Ä–∏ –ø—Ä–æ–±–ª–µ–º–∞—Ö

1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏: `journalctl -u xray-nextjs-ui -n 50`
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ä–µ—Å—É—Ä—Å—ã: `free -h && df -h`
3. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ —Å–µ—Ä–≤–∏—Å—ã: `systemctl restart xray-nextjs-ui xray-report-ui`
4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥: `tail -50 /var/log/xray-services-check.log`
