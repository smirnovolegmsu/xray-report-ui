# üîç –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑ –ø—Ä–æ–µ–∫—Ç–∞ Xray Report UI

**–î–∞—Ç–∞ –∞–Ω–∞–ª–∏–∑–∞:** 2024  
**–ê–Ω–∞–ª–∏—Ç–∏–∫:** AI Code Reviewer  
**–°—Ç–∞—Ç—É—Å:** –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–±–ª–µ–º—ã —Ç—Ä–µ–±—É—é—Ç –Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ–≥–æ –≤–Ω–∏–º–∞–Ω–∏—è

---

## üìã –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ

1. [–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–±–ª–µ–º—ã](#–∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ-–ø—Ä–æ–±–ª–µ–º—ã)
2. [–î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–¥–∞](#–¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ-–∫–æ–¥–∞)
3. [–ù–µ—Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ—Å—Ç–∏](#–Ω–µ—Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ—Å—Ç–∏)
4. [–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã](#–∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ-–ø—Ä–æ–±–ª–µ–º—ã)
5. [–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—é](#—Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏-–ø–æ-–∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—é)

---

## üö® –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–±–ª–µ–º—ã

### 1. –•–∞—Ä–¥–∫–æ–¥ IP –∞–¥—Ä–µ—Å–∞ –≤ production –∫–æ–¥–µ

**–§–∞–π–ª:** `app.py:57`  
**–ü—Ä–æ–±–ª–µ–º–∞:**
```python
NEXTJS_URL = f"http://185.235.130.184:{NEXTJS_PORT}"
```

**–ö—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç—å:** üî¥ **–í–´–°–û–ö–ê–Ø**  
**–ü—Ä–æ–±–ª–µ–º—ã:**
- IP –∞–¥—Ä–µ—Å –∑–∞—Ö–∞—Ä–¥–∫–æ–∂–µ–Ω –≤ –∫–æ–¥–µ
- –ü—Ä–∏ —Å–º–µ–Ω–µ —Å–µ—Ä–≤–µ—Ä–∞/–¥–æ–º–µ–Ω–∞ –∫–æ–¥ –Ω—É–∂–Ω–æ –±—É–¥–µ—Ç –º–µ–Ω—è—Ç—å
- –ù–∞—Ä—É—à–∞–µ—Ç –ø—Ä–∏–Ω—Ü–∏–ø –∫–æ–Ω—Ñ–∏–≥—É—Ä–∏—Ä—É–µ–º–æ—Å—Ç–∏
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ —Å–æ–±—ã—Ç–∏—è—Ö (—Å—Ç—Ä–æ–∫–∏ 434, 447, 455, 463)

**–†–µ—à–µ–Ω–∏–µ:**
```python
NEXTJS_URL = os.environ.get("NEXTJS_URL", f"http://127.0.0.1:{NEXTJS_PORT}")
```

---

### 2. –î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ `handleApiError` —Å —Ä–∞–∑–Ω–æ–π –ª–æ–≥–∏–∫–æ–π

**–§–∞–π–ª—ã:**
- `frontend/lib/api.ts:138-146`
- `frontend/lib/utils.ts:8-16`

**–ü—Ä–æ–±–ª–µ–º–∞:**
```typescript
// –í api.ts
export const handleApiError = (error: any): string => {
  if (error.response?.data?.error) {  // ‚Üê –ü—Ä–æ–≤–µ—Ä—è–µ—Ç 'error'
    return error.response.data.error;
  }
  // ...
}

// –í utils.ts
export function handleApiError(error: any): string {
  if (error.response?.data?.message) {  // ‚Üê –ü—Ä–æ–≤–µ—Ä—è–µ—Ç 'message'
    return error.response.data.message;
  }
  // ...
}
```

**–ö—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç—å:** üî¥ **–í–´–°–û–ö–ê–Ø**  
**–ü—Ä–æ–±–ª–µ–º—ã:**
- –î–≤–µ —Ä–∞–∑–Ω—ã–µ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –æ–¥–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–∏
- –†–∞–∑–Ω–∞—è –ª–æ–≥–∏–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—à–∏–±–æ–∫
- –ú–æ–∂–µ—Ç –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫ –Ω–µ–ø—Ä–µ–¥—Å–∫–∞–∑—É–µ–º–æ–º—É –ø–æ–≤–µ–¥–µ–Ω–∏—é
- –ò—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –≤ —Ä–∞–∑–Ω—ã—Ö –º–µ—Å—Ç–∞—Ö –ø—Ä–æ–µ–∫—Ç–∞

**–†–µ—à–µ–Ω–∏–µ:** –£–¥–∞–ª–∏—Ç—å –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ, –æ—Å—Ç–∞–≤–∏—Ç—å –æ–¥–Ω—É —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—é –≤ `utils.ts` —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π –æ–±–æ–∏—Ö —Ñ–æ—Ä–º–∞—Ç–æ–≤ –æ—Ç–≤–µ—Ç–∞.

---

### 3. –ù–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–π API –º–µ—Ç–æ–¥ `getOnlineData()`

**–§–∞–π–ª:** `frontend/lib/api.ts:69`  
**–ü—Ä–æ–±–ª–µ–º–∞:**
```typescript
getOnlineData: () => api.get<LiveData>('/online'),
```

**–ö—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç—å:** üü° **–°–†–ï–î–ù–Ø–Ø**  
**–ü—Ä–æ–±–ª–µ–º—ã:**
- –≠–Ω–¥–ø–æ–∏–Ω—Ç `/api/online` –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –≤ backend
- –í backend –µ—Å—Ç—å —Ç–æ–ª—å–∫–æ `/api/live` –∏ `/api/live/now`
- –ú–µ—Ç–æ–¥ –Ω–∏–≥–¥–µ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ –ø—Ä–æ–µ–∫—Ç–µ
- –ú–æ–∂–µ—Ç –≤–≤–µ—Å—Ç–∏ –≤ –∑–∞–±–ª—É–∂–¥–µ–Ω–∏–µ —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤

**–†–µ—à–µ–Ω–∏–µ:** –£–¥–∞–ª–∏—Ç—å –º–µ—Ç–æ–¥ –∏–ª–∏ —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–π —ç–Ω–¥–ø–æ–∏–Ω—Ç –≤ backend.

---

### 4. –î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ `formatBytes` –≤ 4 –º–µ—Å—Ç–∞—Ö

**–§–∞–π–ª—ã:**
1. `frontend/lib/utils.ts:24-75` - –ø–æ–ª–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è —Å –æ–ø—Ü–∏—è–º–∏
2. `frontend/components/features/live/live-now.tsx:88-100` - —É–ø—Ä–æ—â–µ–Ω–Ω–∞—è
3. `frontend/components/features/users/user-details-sheet.tsx:68-76` - —É–ø—Ä–æ—â–µ–Ω–Ω–∞—è
4. `frontend/components/features/overview/metrics-cards.tsx:104-112` - —É–ø—Ä–æ—â–µ–Ω–Ω–∞—è

**–ö—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç—å:** üü° **–°–†–ï–î–ù–Ø–Ø**  
**–ü—Ä–æ–±–ª–µ–º—ã:**
- –î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –ª–æ–≥–∏–∫–∏ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –±–∞–π—Ç–æ–≤
- –†–∞–∑–Ω—ã–µ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –º–æ–≥—É—Ç –¥–∞–≤–∞—Ç—å —Ä–∞–∑–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
- –£—Å–ª–æ–∂–Ω—è–µ—Ç –ø–æ–¥–¥–µ—Ä–∂–∫—É (–Ω—É–∂–Ω–æ –æ–±–Ω–æ–≤–ª—è—Ç—å –≤ 4 –º–µ—Å—Ç–∞—Ö)
- –ù–∞—Ä—É—à–∞–µ—Ç –ø—Ä–∏–Ω—Ü–∏–ø DRY (Don't Repeat Yourself)

**–†–µ—à–µ–Ω–∏–µ:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –µ–¥–∏–Ω—É—é —Ñ—É–Ω–∫—Ü–∏—é –∏–∑ `utils.ts` –≤–µ–∑–¥–µ.

---

### 5. Legacy —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã –≤—Å–µ –µ—â–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è

**–§–∞–π–ª—ã:**
- `app.py:2716-2723` - `/api/system/restart-ui` (–ø–æ–º–µ—á–µ–Ω –∫–∞–∫ legacy)
- `app.py:2889-2913` - `/api/live` (–ø–æ–º–µ—á–µ–Ω –∫–∞–∫ legacy SSE)
- `frontend/components/features/settings/system-settings.tsx:47` - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `restartUI()`

**–ö—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç—å:** üü° **–°–†–ï–î–ù–Ø–Ø**  
**–ü—Ä–æ–±–ª–µ–º—ã:**
- Legacy –∫–æ–¥ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ —Å –Ω–æ–≤—ã–º
- –£–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç —Å–ª–æ–∂–Ω–æ—Å—Ç—å –∫–æ–¥–æ–≤–æ–π –±–∞–∑—ã
- –ú–æ–∂–µ—Ç –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫ –ø—É—Ç–∞–Ω–∏—Ü–µ

**–†–µ—à–µ–Ω–∏–µ:** –ú–∏–≥—Ä–∏—Ä–æ–≤–∞—Ç—å –≤—Å–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –Ω–∞ –Ω–æ–≤—ã–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã –∏ —É–¥–∞–ª–∏—Ç—å legacy –∫–æ–¥.

---

## üîÑ –î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–¥–∞

### 6. –î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –º–µ—Ç–æ–¥–æ–≤ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞ —Å–µ—Ä–≤–∏—Å–æ–≤

**–§–∞–π–ª:** `frontend/lib/api.ts`  
**–ü—Ä–æ–±–ª–µ–º–∞:**
```typescript
restartService: (service: string) => api.post<ApiResponse>('/system/restart', { service }),
restartUI: () => api.post<ApiResponse>('/system/restart-ui'),
restartSystem: () => api.post<ApiResponse>('/system/restart'),
```

**–ö—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç—å:** üü¢ **–ù–ò–ó–ö–ê–Ø**  
**–ü—Ä–æ–±–ª–µ–º—ã:**
- `restartUI()` –≤—ã–∑—ã–≤–∞–µ—Ç legacy —ç–Ω–¥–ø–æ–∏–Ω—Ç
- `restartSystem()` –Ω–µ –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä—ã, –Ω–æ –¥–æ–ª–∂–µ–Ω
- `restartService()` - –ø—Ä–∞–≤–∏–ª—å–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è

**–†–µ—à–µ–Ω–∏–µ:** –£–¥–∞–ª–∏—Ç—å `restartUI()` –∏ `restartSystem()`, –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ç–æ–ª—å–∫–æ `restartService()`.

---

### 7. –ú–Ω–æ–∂–µ—Å—Ç–≤–æ —Å–∫—Ä–∏–ø—Ç–æ–≤ –∞–Ω–∞–ª–∏–∑–∞ –ø–æ—Ä—Ç–æ–≤

**–§–∞–π–ª—ã –≤ –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞:**
- `analyze-ports.sh`
- `check-services.sh`
- `cleanup-ports.sh`
- `count-all-ports.sh`
- `explain-all-ports.sh`
- `full-ports-analysis.sh`
- `optimize-ports.sh`

**–ö—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç—å:** üü¢ **–ù–ò–ó–ö–ê–Ø**  
**–ü—Ä–æ–±–ª–µ–º—ã:**
- 7 —Å–∫—Ä–∏–ø—Ç–æ–≤ –¥–ª—è –ø–æ—Ö–æ–∂–∏—Ö –∑–∞–¥–∞—á
- –î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏
- –£—Å–ª–æ–∂–Ω—è–µ—Ç –Ω–∞–≤–∏–≥–∞—Ü–∏—é –ø–æ –ø—Ä–æ–µ–∫—Ç—É
- –ù–µ –≤—Å–µ —Å–∫—Ä–∏–ø—Ç—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è

**–†–µ—à–µ–Ω–∏–µ:** –û–±—ä–µ–¥–∏–Ω–∏—Ç—å –≤ –æ–¥–∏–Ω —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π —Å–∫—Ä–∏–ø—Ç –∏–ª–∏ –ø–µ—Ä–µ–º–µ—Å—Ç–∏—Ç—å –≤ `scripts/` –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é.

---

### 8. –î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏

**–§–∞–π–ª—ã:**
- `PORTS_ANALYSIS.md`
- `–ü–û–†–¢–´_–û–ü–¢–ò–ú–ò–ó–ê–¶–ò–Ø.md` (–¥—É–±–ª–∏–∫–∞—Ç –Ω–∞ —Ä—É—Å—Å–∫–æ–º)
- `SERVICE_STATUS.md`
- `SPEED_OPTIMIZATION.md`
- `frontend/BUILD_OPTIMIZATION.md`

**–ö—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç—å:** üü¢ **–ù–ò–ó–ö–ê–Ø**  
**–ü—Ä–æ–±–ª–µ–º—ã:**
- –î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –ø–æ—Ä—Ç–∞—Ö
- –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è —Ä–∞–∑–±—Ä–æ—Å–∞–Ω–∞ –ø–æ –ø—Ä–æ–µ–∫—Ç—É
- –ú–æ–∂–µ—Ç —É—Å—Ç–∞—Ä–µ—Ç—å –∏ —Å—Ç–∞—Ç—å –ø—Ä–æ—Ç–∏–≤–æ—Ä–µ—á–∏–≤–æ–π

**–†–µ—à–µ–Ω–∏–µ:** –û–±—ä–µ–¥–∏–Ω–∏—Ç—å –≤ –µ–¥–∏–Ω—É—é –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é –∏–ª–∏ –ø–µ—Ä–µ–º–µ—Å—Ç–∏—Ç—å –≤ `docs/` –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é.

---

## ‚ö†Ô∏è –ù–µ—Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ—Å—Ç–∏

### 9. –ù–µ—Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ—Å—Ç—å —Ç–∏–ø–æ–≤ API –æ—Ç–≤–µ—Ç–æ–≤

**–§–∞–π–ª:** `frontend/lib/api.ts`  
**–ü—Ä–æ–±–ª–µ–º–∞:**
```typescript
getLiveNow: () => api.get<any>('/live/now'),  // ‚Üê any –≤–º–µ—Å—Ç–æ —Ç–∏–ø–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –æ—Ç–≤–µ—Ç–∞
getLiveSeries: (...) => api.get<any>('/live/series'),  // ‚Üê any
getUsageDashboard: (...) => api.get<any>('/usage/dashboard'),  // ‚Üê any
```

**–ö—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç—å:** üü° **–°–†–ï–î–ù–Ø–Ø**  
**–ü—Ä–æ–±–ª–µ–º—ã:**
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `any` –≤–º–µ—Å—Ç–æ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã—Ö —Ç–∏–ø–æ–≤
- –ü–æ—Ç–µ—Ä—è –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤ TypeScript
- –ù–µ—Ç –∞–≤—Ç–æ–¥–æ–ø–æ–ª–Ω–µ–Ω–∏—è –∏ –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ç–∏–ø–æ–≤

**–†–µ—à–µ–Ω–∏–µ:** –°–æ–∑–¥–∞—Ç—å —Ç–∏–ø—ã –¥–ª—è –≤—Å–µ—Ö API –æ—Ç–≤–µ—Ç–æ–≤ –≤ `types/index.ts`.

---

### 10. –ù–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–π –∏–º–ø–æ—Ä—Ç `Dashboard`

**–§–∞–π–ª:** `frontend/lib/api.ts:6`  
**–ü—Ä–æ–±–ª–µ–º–∞:**
```typescript
import type {
  Settings,
  User,
  UserStats,
  Dashboard,  // ‚Üê –ò–º–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç—Å—è, –Ω–æ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è
  DashboardApiResponse,
  // ...
} from '@/types';
```

**–ö—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç—å:** üü¢ **–ù–ò–ó–ö–ê–Ø**  
**–†–µ—à–µ–Ω–∏–µ:** –£–¥–∞–ª–∏—Ç—å –Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–π –∏–º–ø–æ—Ä—Ç.

---

### 11. –ù–µ—Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π –ø—É—Ç—å –∫ —à–∞–±–ª–æ–Ω–∞–º

**–§–∞–π–ª:** `app.py:44-46`  
**–ü—Ä–æ–±–ª–µ–º–∞:**
```python
TEMPLATE_INDEX_PATHS = [
    "/opt/xray-report-ui/templates/index.html",  # ‚Üê –§–∞–π–ª –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
]
```

**–ö—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç—å:** üü¢ **–ù–ò–ó–ö–ê–Ø**  
**–ü—Ä–æ–±–ª–µ–º—ã:**
- –£–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞ –Ω–µ—Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π —Ñ–∞–π–ª (legacy –æ—Ç —Å—Ç–∞—Ä–æ–π –≤–µ—Ä—Å–∏–∏)
- –¢–µ–ø–µ—Ä—å –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è Next.js, —à–∞–±–ª–æ–Ω—ã –Ω–µ –Ω—É–∂–Ω—ã
- –ú–æ–∂–µ—Ç –≤—ã–∑–≤–∞—Ç—å –æ—à–∏–±–∫–∏ –ø—Ä–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏

**–†–µ—à–µ–Ω–∏–µ:** –£–¥–∞–ª–∏—Ç—å –∏–ª–∏ –∑–∞–∫–æ–º–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å, –µ—Å–ª–∏ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è.

---

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

### 12. –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

**–ü—Ä–æ–±–ª–µ–º–∞:** –ö–æ–Ω—Å—Ç–∞–Ω—Ç—ã —Ä–∞–∑–±—Ä–æ—Å–∞–Ω—ã –ø–æ —Ñ–∞–π–ª–∞–º:
- `app.py` - —Ö–∞—Ä–¥–∫–æ–¥ –ø—É—Ç–µ–π –∏ –ø–æ—Ä—Ç–æ–≤
- `next.config.ts` - —Ö–∞—Ä–¥–∫–æ–¥ –ø–æ—Ä—Ç–∞ backend (8787)
- –ù–µ—Ç –µ–¥–∏–Ω–æ–≥–æ —Ñ–∞–π–ª–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

**–ö—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç—å:** üü° **–°–†–ï–î–ù–Ø–Ø**  
**–†–µ—à–µ–Ω–∏–µ:** –°–æ–∑–¥–∞—Ç—å `config.py` –¥–ª—è backend –∏ `.env.example` –¥–ª—è frontend.

---

### 13. –°–º–µ—à–∏–≤–∞–Ω–∏–µ –ª–æ–≥–∏–∫–∏ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∏ –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∏

**–ü—Ä–æ–±–ª–µ–º–∞:** –§—É–Ω–∫—Ü–∏–∏ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è (`formatBytes`) –æ–ø—Ä–µ–¥–µ–ª–µ–Ω—ã –≤–Ω—É—Ç—Ä–∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ –≤–º–µ—Å—Ç–æ —É—Ç–∏–ª–∏—Ç.

**–ö—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç—å:** üü¢ **–ù–ò–ó–ö–ê–Ø**  
**–†–µ—à–µ–Ω–∏–µ:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ —É—Ç–∏–ª–∏—Ç—ã –∏–∑ `lib/utils.ts`.

---

## üìù –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—é

### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 1 (–ö—Ä–∏—Ç–∏—á–Ω–æ - –∏—Å–ø—Ä–∞–≤–∏—Ç—å –Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ)

1. ‚úÖ **–£–±—Ä–∞—Ç—å —Ö–∞—Ä–¥–∫–æ–¥ IP –∞–¥—Ä–µ—Å–∞** - –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
2. ‚úÖ **–£–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å `handleApiError`** - –æ—Å—Ç–∞–≤–∏—Ç—å –æ–¥–Ω—É —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—é
3. ‚úÖ **–£–¥–∞–ª–∏—Ç—å –Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–π `getOnlineData()`** –∏–ª–∏ —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —ç–Ω–¥–ø–æ–∏–Ω—Ç

### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 2 (–í–∞–∂–Ω–æ - –∏—Å–ø—Ä–∞–≤–∏—Ç—å –≤ –±–ª–∏–∂–∞–π—à–µ–µ –≤—Ä–µ–º—è)

4. ‚úÖ **–£–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å `formatBytes`** - –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤–µ–∑–¥–µ –∏–∑ `utils.ts`
5. ‚úÖ **–ú–∏–≥—Ä–∏—Ä–æ–≤–∞—Ç—å —Å legacy —ç–Ω–¥–ø–æ–∏–Ω—Ç–æ–≤** - –æ–±–Ω–æ–≤–∏—Ç—å –≤—Å–µ –≤—ã–∑–æ–≤—ã
6. ‚úÖ **–î–æ–±–∞–≤–∏—Ç—å —Ç–∏–ø—ã –¥–ª—è API –æ—Ç–≤–µ—Ç–æ–≤** - –∑–∞–º–µ–Ω–∏—Ç—å `any` –Ω–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ —Ç–∏–ø—ã

### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 3 (–ñ–µ–ª–∞—Ç–µ–ª—å–Ω–æ - —É–ª—É—á—à–∏—Ç—å –∫–∞—á–µ—Å—Ç–≤–æ –∫–æ–¥–∞)

7. ‚úÖ **–†–µ–æ—Ä–≥–∞–Ω–∏–∑–æ–≤–∞—Ç—å —Å–∫—Ä–∏–ø—Ç—ã** - –æ–±—ä–µ–¥–∏–Ω–∏—Ç—å –∏–ª–∏ –ø–µ—Ä–µ–º–µ—Å—Ç–∏—Ç—å –≤ `scripts/`
8. ‚úÖ **–û–±—ä–µ–¥–∏–Ω–∏—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é** - —Å–æ–∑–¥–∞—Ç—å –µ–¥–∏–Ω—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É
9. ‚úÖ **–°–æ–∑–¥–∞—Ç—å —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—É—é –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é** - –≤—ã–Ω–µ—Å—Ç–∏ –≤—Å–µ –∫–æ–Ω—Å—Ç–∞–Ω—Ç—ã

---

## üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø—Ä–æ–±–ª–µ–º

- **–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –ø—Ä–æ–±–ª–µ–º:** 3
- **–°—Ä–µ–¥–Ω–∏—Ö –ø—Ä–æ–±–ª–µ–º:** 4
- **–ù–∏–∑–∫–∏—Ö –ø—Ä–æ–±–ª–µ–º:** 6
- **–í—Å–µ–≥–æ –Ω–∞–π–¥–µ–Ω–æ:** 13 –ø—Ä–æ–±–ª–µ–º

---

## ‚úÖ –ß–µ–∫–ª–∏—Å—Ç –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π

- [x] –ò—Å–ø—Ä–∞–≤–∏—Ç—å —Ö–∞—Ä–¥–∫–æ–¥ IP –∞–¥—Ä–µ—Å–∞ ‚úÖ **–ò–°–ü–†–ê–í–õ–ï–ù–û**
- [x] –£–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å `handleApiError` ‚úÖ **–ò–°–ü–†–ê–í–õ–ï–ù–û**
- [x] –£–¥–∞–ª–∏—Ç—å/–∏—Å–ø—Ä–∞–≤–∏—Ç—å `getOnlineData()` ‚úÖ **–ò–°–ü–†–ê–í–õ–ï–ù–û** (—É–¥–∞–ª–µ–Ω, –¥–æ–±–∞–≤–ª–µ–Ω –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π)
- [x] –£–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å `formatBytes` ‚úÖ **–ò–°–ü–†–ê–í–õ–ï–ù–û** (–≤—Å–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç utils)
- [x] –£–¥–∞–ª–∏—Ç—å –Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –∏–º–ø–æ—Ä—Ç—ã ‚úÖ **–ò–°–ü–†–ê–í–õ–ï–ù–û** (—É–¥–∞–ª–µ–Ω Dashboard)
- [x] –ú–∏–≥—Ä–∏—Ä–æ–≤–∞—Ç—å —Å legacy —ç–Ω–¥–ø–æ–∏–Ω—Ç–æ–≤ ‚úÖ **–ò–°–ü–†–ê–í–õ–ï–ù–û** (restartUI/restartSystem ‚Üí restartService)
- [x] –î–æ–±–∞–≤–∏—Ç—å —Ç–∏–ø—ã –¥–ª—è API –æ—Ç–≤–µ—Ç–æ–≤ ‚úÖ **–ò–°–ü–†–ê–í–õ–ï–ù–û** (–≤—Å–µ any –∑–∞–º–µ–Ω–µ–Ω—ã –Ω–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ —Ç–∏–ø—ã)
- [ ] –†–µ–æ—Ä–≥–∞–Ω–∏–∑–æ–≤–∞—Ç—å —Å–∫—Ä–∏–ø—Ç—ã (–Ω–∏–∑–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç - –º–æ–∂–Ω–æ –æ—Å—Ç–∞–≤–∏—Ç—å –∫–∞–∫ –µ—Å—Ç—å)
- [ ] –û–±—ä–µ–¥–∏–Ω–∏—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é (–Ω–∏–∑–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç - –º–æ–∂–Ω–æ –æ—Å—Ç–∞–≤–∏—Ç—å –∫–∞–∫ –µ—Å—Ç—å)
- [ ] –°–æ–∑–¥–∞—Ç—å —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—É—é –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é (–Ω–∏–∑–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç - –º–æ–∂–Ω–æ –æ—Å—Ç–∞–≤–∏—Ç—å –∫–∞–∫ –µ—Å—Ç—å)

---

## üìù –í—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

### ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ 1: –•–∞—Ä–¥–∫–æ–¥ IP –∞–¥—Ä–µ—Å–∞
**–§–∞–π–ª:** `app.py:57`  
**–ò–∑–º–µ–Ω–µ–Ω–∏–µ:**
```python
# –ë—ã–ª–æ:
NEXTJS_URL = f"http://185.235.130.184:{NEXTJS_PORT}"

# –°—Ç–∞–ª–æ:
NEXTJS_URL = os.environ.get("NEXTJS_URL", f"http://127.0.0.1:{NEXTJS_PORT}")
```
–¢–µ–ø–µ—Ä—å –º–æ–∂–Ω–æ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å —á–µ—Ä–µ–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é –æ–∫—Ä—É–∂–µ–Ω–∏—è `NEXTJS_URL`.

### ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ 2: –£–Ω–∏—Ñ–∏–∫–∞—Ü–∏—è handleApiError
**–§–∞–π–ª—ã:** `frontend/lib/utils.ts`, `frontend/lib/api.ts`  
**–ò–∑–º–µ–Ω–µ–Ω–∏—è:**
- –û–±—ä–µ–¥–∏–Ω–µ–Ω–∞ –ª–æ–≥–∏–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—à–∏–±–æ–∫ (–ø–æ–¥–¥–µ—Ä–∂–∫–∞ –∏ `error`, –∏ `message` –ø–æ–ª–µ–π)
- `api.ts` —Ç–µ–ø–µ—Ä—å —Ä–µ—ç–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç —Ñ—É–Ω–∫—Ü–∏—é –∏–∑ `utils.ts`
- –í—Å–µ –∏–º–ø–æ—Ä—Ç—ã –æ–±–Ω–æ–≤–ª–µ–Ω—ã –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –µ–¥–∏–Ω–æ–π –≤–µ—Ä—Å–∏–∏

### ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ 3: –£–¥–∞–ª–µ–Ω–∏–µ –Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º–æ–≥–æ getOnlineData()
**–§–∞–π–ª:** `frontend/lib/api.ts`  
**–ò–∑–º–µ–Ω–µ–Ω–∏–µ:** –ú–µ—Ç–æ–¥ —É–¥–∞–ª–µ–Ω, –¥–æ–±–∞–≤–ª–µ–Ω –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Å –æ–±—ä—è—Å–Ω–µ–Ω–∏–µ–º.

### ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ 4: –£–Ω–∏—Ñ–∏–∫–∞—Ü–∏—è formatBytes
**–§–∞–π–ª—ã:**
- `frontend/components/features/live/live-now.tsx`
- `frontend/components/features/users/user-details-sheet.tsx`
- `frontend/components/features/overview/metrics-cards.tsx`

**–ò–∑–º–µ–Ω–µ–Ω–∏—è:** –í—Å–µ –ª–æ–∫–∞–ª—å–Ω—ã–µ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ —É–¥–∞–ª–µ–Ω—ã, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –µ–¥–∏–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –∏–∑ `utils.ts`.

### ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ 5: –£–¥–∞–ª–µ–Ω–∏–µ –Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º–æ–≥–æ –∏–º–ø–æ—Ä—Ç–∞
**–§–∞–π–ª:** `frontend/lib/api.ts`  
**–ò–∑–º–µ–Ω–µ–Ω–∏–µ:** –£–¥–∞–ª–µ–Ω –Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–π –∏–º–ø–æ—Ä—Ç `Dashboard`.

### ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ 6: –ú–∏–≥—Ä–∞—Ü–∏—è —Å legacy —ç–Ω–¥–ø–æ–∏–Ω—Ç–æ–≤
**–§–∞–π–ª—ã:** `frontend/lib/api.ts`, `frontend/components/features/settings/system-settings.tsx`, `frontend/components/ui/connection-error.tsx`  
**–ò–∑–º–µ–Ω–µ–Ω–∏—è:**
- `restartUI()` –∏ `restartSystem()` –ø–æ–º–µ—á–µ–Ω—ã –∫–∞–∫ `@deprecated`
- –í—Å–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –∑–∞–º–µ–Ω–µ–Ω—ã –Ω–∞ `restartService('ui')` –∏ `restartService('all')`
- Legacy –º–µ—Ç–æ–¥—ã –æ—Å—Ç–∞–≤–ª–µ–Ω—ã –¥–ª—è –æ–±—Ä–∞—Ç–Ω–æ–π —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏, –Ω–æ –∏—Å–ø–æ–ª—å–∑—É—é—Ç –Ω–æ–≤—ã–π —ç–Ω–¥–ø–æ–∏–Ω—Ç

### ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ 7: –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ç–∏–ø–æ–≤ –¥–ª—è API –æ—Ç–≤–µ—Ç–æ–≤
**–§–∞–π–ª—ã:** `frontend/types/index.ts`, `frontend/lib/api.ts`  
**–ò–∑–º–µ–Ω–µ–Ω–∏—è:**
- –î–æ–±–∞–≤–ª–µ–Ω—ã —Ç–∏–ø—ã: `SystemStatus`, `SystemResources`, `PortsStatusResponse`, `LiveNowResponse`, `LiveSeriesResponse`, `LiveTopResponse`, `UsageDashboardResponse`, `EventsStatsResponse`, `CollectorStatus`, `XrayConfig`, `Backup`
- –í—Å–µ `any` —Ç–∏–ø—ã –≤ API –∫–ª–∏–µ–Ω—Ç–µ –∑–∞–º–µ–Ω–µ–Ω—ã –Ω–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ —Ç–∏–ø—ã
- –£–ª—É—á—à–µ–Ω–∞ —Ç–∏–ø–æ–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –≤—Å–µ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞

---

**–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:** –≠—Ç–æ—Ç –∞–Ω–∞–ª–∏–∑ –æ—Å–Ω–æ–≤–∞–Ω –Ω–∞ —Å—Ç–∞—Ç–∏—á–µ—Å–∫–æ–º –∞–Ω–∞–ª–∏–∑–µ –∫–æ–¥–∞. –ù–µ–∫–æ—Ç–æ—Ä—ã–µ –ø—Ä–æ–±–ª–µ–º—ã –º–æ–≥—É—Ç –±—ã—Ç—å –ª–æ–∂–Ω—ã–º–∏ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏—è–º–∏ –∏–ª–∏ –∏–º–µ—Ç—å –æ–±–æ—Å–Ω–æ–≤–∞–Ω–Ω—ã–µ –ø—Ä–∏—á–∏–Ω—ã. –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–∞–∂–¥—É—é –ø—Ä–æ–±–ª–µ–º—É –ø–µ—Ä–µ–¥ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ–º.
