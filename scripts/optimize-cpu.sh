#!/bin/bash
# –°–∫—Ä–∏–ø—Ç –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –Ω–∞–≥—Ä—É–∑–∫–∏ –Ω–∞ CPU

echo "üîç –ê–Ω–∞–ª–∏–∑ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤, –ø–æ—Ç—Ä–µ–±–ª—è—é—â–∏—Ö CPU..."

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ —Å–±–æ—Ä–∫–∏
BUILD_PROCESSES=$(ps aux | grep -E "build:fast|npm.*build|next.*build" | grep -v grep | wc -l)
if [ "$BUILD_PROCESSES" -gt 0 ]; then
    echo "‚ö†Ô∏è  –ù–∞–π–¥–µ–Ω—ã –ø—Ä–æ—Ü–µ—Å—Å—ã —Å–±–æ—Ä–∫–∏:"
    ps aux | grep -E "build:fast|npm.*build|next.*build" | grep -v grep
    echo ""
    read -p "–û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø—Ä–æ—Ü–µ—Å—Å—ã —Å–±–æ—Ä–∫–∏? (y/n) " -n 1 -r
    echo
    if [[ $REPLY =~ ^[Yy]$ ]]; then
        pkill -f "build:fast"
        pkill -f "npm.*build"
        echo "‚úÖ –ü—Ä–æ—Ü–µ—Å—Å—ã —Å–±–æ—Ä–∫–∏ –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã"
    fi
else
    echo "‚úÖ –ü—Ä–æ—Ü–µ—Å—Å—ã —Å–±–æ—Ä–∫–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã"
fi

echo ""
echo "üìä –¢–æ–ø –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ –ø–æ CPU:"
ps aux --sort=-%cpu | head -10 | awk '{printf "%-8s %5s%% %8sMB %s\n", $1, $3, $6/1024, $11}'

echo ""
echo "üí° –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:"
echo "1. bashtop —Å–∞–º –ø–æ—Ç—Ä–µ–±–ª—è–µ—Ç –º–Ω–æ–≥–æ CPU (—ç—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–æ–≤)"
echo "2. TypeScript —Å–µ—Ä–≤–µ—Ä—ã —Ä–∞–±–æ—Ç–∞—é—Ç –¥–ª—è IDE - –º–æ–∂–Ω–æ –∑–∞–∫—Ä—ã—Ç—å, –µ—Å–ª–∏ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ"
echo "3. Cursor Server - —Å–µ—Ä–≤–µ—Ä –¥–ª—è IDE —á–µ—Ä–µ–∑ SSH"
echo ""
echo "–î–ª—è —Å–Ω–∏–∂–µ–Ω–∏—è –Ω–∞–≥—Ä—É–∑–∫–∏:"
echo "- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ 'htop' –≤–º–µ—Å—Ç–æ 'bashtop' (–º–µ–Ω—å—à–µ –Ω–∞–≥—Ä—É–∑–∫–∞)"
echo "- –ó–∞–∫—Ä–æ–π—Ç–µ IDE, –µ—Å–ª–∏ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ –∞–∫—Ç–∏–≤–Ω–æ"
echo "- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –ø—Ä–æ—Ü–µ—Å—Å—ã —Å–±–æ—Ä–∫–∏ –Ω–µ –∑–∞–ø—É—â–µ–Ω—ã –≤ —Ñ–æ–Ω–µ"
