#!/bin/bash
# –ë—ã—Å—Ç—Ä–∞—è —Å–±–æ—Ä–∫–∞ —Å –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è–º–∏

set -e

echo "üöÄ –ë—ã—Å—Ç—Ä–∞—è —Å–±–æ—Ä–∫–∞ Next.js –ø—Ä–æ–µ–∫—Ç–∞..."
echo ""

# –û—á–∏—Å—Ç–∫–∞ —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –Ω—É–∂–Ω–æ
if [ "$1" == "--clean" ]; then
    echo "üßπ –û—á–∏—Å—Ç–∫–∞ –∫–µ—à–∞..."
    rm -rf .next
    rm -rf node_modules/.cache
fi

# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –¥–ª—è —É—Å–∫–æ—Ä–µ–Ω–∏—è
export SKIP_TYPE_CHECK=true
export SKIP_LINT=true
export NODE_ENV=production

echo "‚è±Ô∏è  –ó–∞–ø—É—Å–∫ —Å–±–æ—Ä–∫–∏ (–±–µ–∑ –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ç–∏–ø–æ–≤ –∏ –ª–∏–Ω—Ç–∏–Ω–≥–∞)..."
echo ""

# –ó–∞–º–µ—Ä –≤—Ä–µ–º–µ–Ω–∏
START_TIME=$(date +%s)

# –°–±–æ—Ä–∫–∞
npm run build

END_TIME=$(date +%s)
ELAPSED=$((END_TIME - START_TIME))

echo ""
echo "‚úÖ –°–±–æ—Ä–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞ –∑–∞ ${ELAPSED} —Å–µ–∫—É–Ω–¥"
echo ""
echo "üí° –î–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ç–∏–ø–æ–≤ –æ—Ç–¥–µ–ª—å–Ω–æ –∑–∞–ø—É—Å—Ç–∏—Ç–µ: npm run type-check"
echo "üí° –î–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –ª–∏–Ω—Ç–∏–Ω–≥–∞ –æ—Ç–¥–µ–ª—å–Ω–æ –∑–∞–ø—É—Å—Ç–∏—Ç–µ: npm run lint"
